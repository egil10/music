<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Your Spotify Journey - Complete Music Analytics</title>
  
  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  
  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-dayjs@1.0.1/dist/chartjs-adapter-dayjs.bundle.min.js"></script>
  
  <!-- Swiper.js for carousels -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css">
  <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
  
  <!-- Cal-Heatmap for daily heatmap -->
  <script src="https://cdn.jsdelivr.net/npm/cal-heatmap@6.0.0/dist/index.global.min.js"></script>
  
  <!-- html2canvas for sharing -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  
  <!-- GSAP for animations -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
  
  <style>
    :root {
      /* Spotify Colors */
      --spotify-green: #1DB954;
      --spotify-dark: #121212;
      --spotify-light: #282828;
      --spotify-lighter: #404040;
      --spotify-text: #FFFFFF;
      --spotify-text-secondary: #B3B3B3;
      
      /* Gradients */
      --gradient-primary: linear-gradient(135deg, #1DB954 0%, #1ed760 100%);
      --gradient-secondary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --gradient-dark: linear-gradient(135deg, #121212 0%, #282828 100%);
      
      /* Shadows */
      --shadow-sm: 0 2px 4px rgba(0,0,0,0.1);
      --shadow-md: 0 4px 8px rgba(0,0,0,0.15);
      --shadow-lg: 0 8px 16px rgba(0,0,0,0.2);
      --shadow-xl: 0 20px 40px rgba(0,0,0,0.3);
      
      /* Transitions */
      --transition-fast: 0.2s ease;
      --transition-normal: 0.3s ease;
      --transition-slow: 0.5s ease;
      
      /* Mobile breakpoints */
      --mobile: 768px;
      --tablet: 1024px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--spotify-dark);
      color: var(--spotify-text);
      line-height: 1.6;
      overflow-x: hidden;
      transition: var(--transition-normal);
    }

    /* Dark mode support */
    body.dark-mode {
      --spotify-dark: #000000;
      --spotify-light: #1a1a1a;
      --spotify-lighter: #2a2a2a;
    }

    /* Custom Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }
    ::-webkit-scrollbar-track {
      background: var(--spotify-light);
    }
    ::-webkit-scrollbar-thumb {
      background: var(--spotify-green);
      border-radius: 4px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: #1ed760;
    }

    /* Header with hamburger menu */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: rgba(18, 18, 18, 0.95);
      backdrop-filter: blur(10px);
      z-index: 1000;
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid var(--spotify-lighter);
    }

    .header h1 {
      font-size: 1.5rem;
      font-weight: 700;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .header-controls {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .dark-mode-toggle {
      background: none;
      border: none;
      color: var(--spotify-text);
      font-size: 1.2rem;
      cursor: pointer;
      padding: 0.5rem;
      border-radius: 50%;
      transition: var(--transition-fast);
    }

    .dark-mode-toggle:hover {
      background: var(--spotify-lighter);
    }

    .hamburger-menu {
      display: none;
      background: none;
      border: none;
      color: var(--spotify-text);
      font-size: 1.5rem;
      cursor: pointer;
      padding: 0.5rem;
    }

    /* Mobile navigation */
    .mobile-nav {
      position: fixed;
      top: 0;
      left: -100%;
      width: 80%;
      max-width: 300px;
      height: 100vh;
      background: var(--spotify-dark);
      z-index: 1001;
      transition: var(--transition-normal);
      padding: 2rem;
      border-right: 1px solid var(--spotify-lighter);
    }

    .mobile-nav.active {
      left: 0;
    }

    .mobile-nav-close {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: none;
      border: none;
      color: var(--spotify-text);
      font-size: 1.5rem;
      cursor: pointer;
    }

    .mobile-nav-links {
      margin-top: 3rem;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .mobile-nav-link {
      color: var(--spotify-text);
      text-decoration: none;
      padding: 1rem;
      border-radius: 8px;
      transition: var(--transition-fast);
      font-weight: 500;
    }

    .mobile-nav-link:hover {
      background: var(--spotify-lighter);
      color: var(--spotify-green);
    }

    /* Hero Section */
    .hero {
      min-height: 100vh;
      background: var(--gradient-dark);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      position: relative;
      overflow: hidden;
      padding: 2rem;
      margin-top: 80px;
    }

    .hero::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="1" fill="%231DB954" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
      opacity: 0.3;
    }

    .hero-content {
      position: relative;
      z-index: 2;
      max-width: 800px;
    }

    .hero h1 {
      font-size: clamp(2.5rem, 8vw, 5rem);
      font-weight: 900;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 1rem;
      animation: fadeInUp 1s ease;
    }

    .hero p {
      font-size: clamp(1rem, 3vw, 1.5rem);
      color: var(--spotify-text-secondary);
      margin-bottom: 2rem;
      animation: fadeInUp 1s ease 0.2s both;
    }

    .scroll-indicator {
      position: absolute;
      bottom: 2rem;
      left: 50%;
      transform: translateX(-50%);
      animation: bounce 2s infinite;
      color: var(--spotify-green);
      font-size: 2rem;
    }

    /* Main Dashboard */
    .dashboard {
      padding: 2rem 1rem;
      max-width: 1400px;
      margin: 0 auto;
    }

    @media (min-width: 768px) {
      .dashboard {
        padding: 4rem 2rem;
      }
    }

    .section {
      margin-bottom: 3rem;
      animation: fadeInUp 0.8s ease;
    }

    @media (min-width: 768px) {
      .section {
        margin-bottom: 4rem;
      }
    }

    .section-title {
      font-size: clamp(1.8rem, 5vw, 2.5rem);
      font-weight: 700;
      margin-bottom: 1.5rem;
      text-align: center;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* Stats Grid - Responsive (Feature 5) */
    .stats-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    @media (min-width: 768px) {
      .stats-grid {
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 2rem;
        margin-bottom: 4rem;
      }
    }

    .stat-card {
      background: var(--spotify-light);
      border-radius: 16px;
      padding: 1.5rem;
      text-align: center;
      box-shadow: var(--shadow-md);
      transition: var(--transition-normal);
      border: 1px solid var(--spotify-lighter);
      min-height: 120px;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .stat-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-xl);
      border-color: var(--spotify-green);
    }

    .stat-icon {
      font-size: 2rem;
      color: var(--spotify-green);
      margin-bottom: 0.5rem;
    }

    @media (min-width: 768px) {
      .stat-icon {
        font-size: 3rem;
        margin-bottom: 1rem;
      }
    }

    .stat-value {
      font-size: 1.8rem;
      font-weight: 800;
      margin-bottom: 0.25rem;
      color: var(--spotify-text);
    }

    @media (min-width: 768px) {
      .stat-value {
        font-size: 2.5rem;
        margin-bottom: 0.5rem;
      }
    }

    .stat-label {
      color: var(--spotify-text-secondary);
      font-size: 0.9rem;
      font-weight: 500;
    }

    @media (min-width: 768px) {
      .stat-label {
        font-size: 1rem;
      }
    }

    /* Year Selector - Interactive (Feature 6) */
    .year-selector {
      display: flex;
      gap: 0.5rem;
      overflow-x: auto;
      padding: 1rem 0;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .year-selector::-webkit-scrollbar {
      display: none;
    }

    @media (min-width: 768px) {
      .year-selector {
        justify-content: center;
        gap: 1rem;
        overflow-x: visible;
      }
    }

    .year-button {
      background: var(--spotify-light);
      border: 1px solid var(--spotify-lighter);
      color: var(--spotify-text);
      padding: 0.75rem 1.5rem;
      border-radius: 50px;
      cursor: pointer;
      transition: var(--transition-fast);
      white-space: nowrap;
      min-height: 48px;
      font-weight: 500;
    }

    .year-button:hover,
    .year-button.active {
      background: var(--gradient-primary);
      border-color: var(--spotify-green);
      color: white;
    }

    /* Chart Containers */
    .charts-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    @media (min-width: 768px) {
      .charts-grid {
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 2rem;
        margin-bottom: 4rem;
      }
    }

    .chart-container {
      background: var(--spotify-light);
      border-radius: 16px;
      padding: 1.5rem;
      box-shadow: var(--shadow-md);
      transition: var(--transition-normal);
      border: 1px solid var(--spotify-lighter);
    }

    @media (min-width: 768px) {
      .chart-container {
        padding: 2rem;
      }
    }

    .chart-container:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-lg);
      border-color: var(--spotify-green);
    }

    .chart-title {
      font-size: 1.2rem;
      font-weight: 600;
      margin-bottom: 1rem;
      text-align: center;
      color: var(--spotify-text);
    }

    @media (min-width: 768px) {
      .chart-title {
        font-size: 1.5rem;
        margin-bottom: 1.5rem;
      }
    }

    .chart-wrapper {
      position: relative;
      height: 250px;
    }

    @media (min-width: 768px) {
      .chart-wrapper {
        height: 300px;
      }
    }

    /* Loading States - Enhanced (Feature 1) */
    .loading {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 4rem 2rem;
      color: var(--spotify-text-secondary);
      min-height: 60vh;
    }

    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 4px solid var(--spotify-lighter);
      border-top: 4px solid var(--spotify-green);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 1.5rem;
    }

    @media (min-width: 768px) {
      .loading-spinner {
        width: 50px;
        height: 50px;
        margin-bottom: 1rem;
      }
    }

    .loading p {
      font-size: 1.1rem;
      text-align: center;
      max-width: 400px;
    }

    .loading-timeout {
      text-align: center;
      max-width: 500px;
    }

    .loading-timeout h2 {
      color: var(--spotify-text);
      margin-bottom: 1rem;
    }

    /* Error States - Enhanced (Feature 1) */
    .error-state {
      text-align: center;
      padding: 4rem 2rem;
      color: var(--spotify-text);
      min-height: 60vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    .error-icon {
      font-size: 4rem;
      margin-bottom: 1rem;
    }

    .error-title {
      font-size: 1.8rem;
      font-weight: 700;
      margin-bottom: 1rem;
      color: var(--spotify-text);
    }

    @media (min-width: 768px) {
      .error-title {
        font-size: 2rem;
      }
    }

    .error-message {
      font-size: 1rem;
      color: var(--spotify-text-secondary);
      margin-bottom: 2rem;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    /* Touch-friendly buttons (Feature 20) */
    .retry-button,
    .action-button {
      background: var(--gradient-primary);
      color: white;
      border: none;
      padding: 1rem 2rem;
      border-radius: 50px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition-fast);
      min-height: 48px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      text-decoration: none;
    }

    .retry-button:hover,
    .action-button:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    .retry-button:active,
    .action-button:active {
      transform: translateY(0);
    }

    /* Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% {
        transform: translateX(-50%) translateY(0);
      }
      40% {
        transform: translateX(-50%) translateY(-10px);
      }
      60% {
        transform: translateX(-50%) translateY(-5px);
      }
    }

    /* Mobile-specific styles */
    @media (max-width: 767px) {
      .hamburger-menu {
        display: block;
      }
      
      .header h1 {
        font-size: 1.2rem;
      }
      
      .hero {
        padding: 1rem;
        margin-top: 70px;
      }
      
      .chart-container {
        margin: 0 -0.5rem;
        border-radius: 12px;
      }
    }

         /* Additional mobile optimizations */
     @media (max-width: 767px) {
       .stat-card {
         padding: 1rem;
         min-height: 100px;
       }
       
       .year-button {
         padding: 0.5rem 1rem;
         font-size: 0.9rem;
       }
       
       .chart-wrapper {
         height: 200px;
       }
     }

     /* Swiper Carousel Styles (Feature 11) */
     .swiper-container {
       width: 100%;
       height: 300px;
       margin: 2rem 0;
     }

     .swiper-slide {
       text-align: center;
       background: var(--spotify-light);
       border-radius: 16px;
       padding: 2rem;
       display: flex;
       flex-direction: column;
       justify-content: center;
       align-items: center;
       border: 1px solid var(--spotify-lighter);
     }

     .swiper-slide img {
       width: 80px;
       height: 80px;
       border-radius: 50%;
       margin-bottom: 1rem;
       object-fit: cover;
     }

     .swiper-slide h3 {
       color: var(--spotify-text);
       margin-bottom: 0.5rem;
       font-size: 1.2rem;
     }

     .swiper-slide p {
       color: var(--spotify-text-secondary);
       font-size: 0.9rem;
     }

     .swiper-button-next,
     .swiper-button-prev {
       color: var(--spotify-green);
     }

     .swiper-pagination-bullet {
       background: var(--spotify-green);
     }

     /* Search Styles (Feature 16) */
     .search-container {
       max-width: 600px;
       margin: 0 auto;
     }

     .search-input-wrapper {
       display: flex;
       gap: 0.5rem;
       margin-bottom: 1rem;
     }

     .search-input {
       flex: 1;
       padding: 1rem;
       border: 1px solid var(--spotify-lighter);
       border-radius: 50px;
       background: var(--spotify-light);
       color: var(--spotify-text);
       font-size: 1rem;
       min-height: 48px;
     }

     .search-input:focus {
       outline: none;
       border-color: var(--spotify-green);
     }

     .search-button {
       background: var(--gradient-primary);
       color: white;
       border: none;
       padding: 1rem;
       border-radius: 50%;
       cursor: pointer;
       min-width: 48px;
       min-height: 48px;
       display: flex;
       align-items: center;
       justify-content: center;
     }

     .search-results {
       max-height: 400px;
       overflow-y: auto;
       border: 1px solid var(--spotify-lighter);
       border-radius: 12px;
       background: var(--spotify-light);
     }

     .search-result-item {
       padding: 1rem;
       border-bottom: 1px solid var(--spotify-lighter);
       cursor: pointer;
       transition: var(--transition-fast);
     }

     .search-result-item:hover {
       background: var(--spotify-lighter);
     }

     .search-result-item:last-child {
       border-bottom: none;
     }

     /* Share Buttons (Feature 18) */
     .share-buttons {
       display: flex;
       gap: 1rem;
       justify-content: center;
       flex-wrap: wrap;
     }

     /* Footer Styles (Feature 28) */
     .footer {
       background: var(--spotify-light);
       border-top: 1px solid var(--spotify-lighter);
       padding: 2rem;
       margin-top: 4rem;
     }

     .footer-content {
       display: flex;
       justify-content: space-between;
       align-items: center;
       max-width: 1400px;
       margin: 0 auto;
     }

     .back-to-top {
       background: var(--gradient-primary);
       color: white;
       border: none;
       padding: 1rem;
       border-radius: 50%;
       cursor: pointer;
       min-width: 48px;
       min-height: 48px;
       display: flex;
       align-items: center;
       justify-content: center;
       transition: var(--transition-fast);
     }

     .back-to-top:hover {
       transform: translateY(-2px);
       box-shadow: var(--shadow-lg);
     }

     /* Daily Heatmap Styles (Feature 9) */
     #dailyHeatmap {
       width: 100%;
       height: 300px;
       display: flex;
       align-items: center;
       justify-content: center;
     }

     /* Mobile responsive adjustments */
     @media (max-width: 767px) {
       .swiper-container {
         height: 250px;
       }

       .swiper-slide {
         padding: 1rem;
       }

       .swiper-slide img {
         width: 60px;
         height: 60px;
       }

       .search-input-wrapper {
         flex-direction: column;
       }

       .search-button {
         align-self: flex-end;
       }

       .share-buttons {
         flex-direction: column;
         align-items: center;
       }

       .footer-content {
         flex-direction: column;
         gap: 1rem;
         text-align: center;
       }
     }
   </style>
</head>
<body>
  <!-- Header with hamburger menu (Feature 10) -->
  <header class="header">
    <h1>Your Spotify Journey</h1>
    <div class="header-controls">
      <button class="dark-mode-toggle" id="darkModeToggle" aria-label="Toggle dark mode">
        <i class="fas fa-moon"></i>
      </button>
      <button class="hamburger-menu" id="hamburgerMenu" aria-label="Open menu">
        <i class="fas fa-bars"></i>
      </button>
    </div>
  </header>

  <!-- Mobile Navigation (Feature 10) -->
  <nav class="mobile-nav" id="mobileNav">
    <button class="mobile-nav-close" id="mobileNavClose">
      <i class="fas fa-times"></i>
    </button>
    <div class="mobile-nav-links">
      <a href="#stats" class="mobile-nav-link">Stats Overview</a>
      <a href="#charts" class="mobile-nav-link">Listening Patterns</a>
      <a href="#artists" class="mobile-nav-link">Top Artists</a>
      <a href="#tracks" class="mobile-nav-link">Top Tracks</a>
      <a href="#sessions" class="mobile-nav-link">Binge Sessions</a>
      <a href="#devices" class="mobile-nav-link">Device Usage</a>
      <a href="#search" class="mobile-nav-link">Music Explorer</a>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero">
    <div class="hero-content">
      <h1>Your Complete Music Journey</h1>
      <p>10+ years of music, memories, and moments</p>
    </div>
    <div class="scroll-indicator">
      <i class="fas fa-chevron-down"></i>
    </div>
  </section>

  <!-- Main Dashboard -->
  <main class="dashboard">
    <!-- Loading State - Enhanced (Feature 1) -->
    <div id="loading" class="loading">
      <div class="loading-spinner"></div>
      <p>Loading your complete music history...</p>
    </div>

    <!-- Dashboard Content -->
    <div id="dashboard-content" style="display: none;">
      <!-- Stats Overview -->
      <section class="section" id="stats">
        <h2 class="section-title">Your Music Stats</h2>
        <div class="stats-grid" id="stats-grid">
          <!-- Stats will be populated here -->
        </div>
      </section>

      <!-- Year Selector -->
      <section class="section">
        <div class="year-selector" id="year-selector">
          <!-- Year buttons will be populated here -->
        </div>
      </section>

      <!-- Charts Grid -->
      <section class="section" id="charts">
        <h2 class="section-title">Your Listening Patterns</h2>
        <div class="charts-grid">
          <div class="chart-container">
            <h3 class="chart-title">Listening Hours by Year</h3>
            <div class="chart-wrapper">
              <canvas id="hoursByYearChart"></canvas>
            </div>
          </div>
          
          <div class="chart-container">
            <h3 class="chart-title">Top Artists (All Time)</h3>
            <div class="chart-wrapper">
              <canvas id="topArtistsChart"></canvas>
            </div>
          </div>
          
          <div class="chart-container">
            <h3 class="chart-title">Listening by Hour of Day</h3>
            <div class="chart-wrapper">
              <canvas id="hourlyChart"></canvas>
            </div>
          </div>
          
          <div class="chart-container">
            <h3 class="chart-title">Listening by Day of Week</h3>
            <div class="chart-wrapper">
              <canvas id="dayOfWeekChart"></canvas>
            </div>
          </div>
          
          <div class="chart-container">
            <h3 class="chart-title">Monthly Listening Trends</h3>
            <div class="chart-wrapper">
              <canvas id="monthlyChart"></canvas>
            </div>
          </div>
          
          <div class="chart-container">
            <h3 class="chart-title">Top Tracks (All Time)</h3>
            <div class="chart-wrapper">
              <canvas id="topTracksChart"></canvas>
            </div>
          </div>
        </div>
      </section>

             <!-- Advanced Analytics Section -->
       <section class="section" id="advanced">
         <h2 class="section-title">Advanced Analytics</h2>
         <div class="charts-grid">
           <!-- Mood Radar Chart (Feature 7) -->
           <div class="chart-container">
             <h3 class="chart-title">Music Mood Radar</h3>
             <div class="chart-wrapper">
               <canvas id="moodRadarChart"></canvas>
             </div>
           </div>
           
           <!-- Genre Pie Chart (Feature 8) -->
           <div class="chart-container">
             <h3 class="chart-title">Genre Breakdown</h3>
             <div class="chart-wrapper">
               <canvas id="genreChart"></canvas>
             </div>
           </div>
           
           <!-- Device Usage Donut Chart (Feature 15) -->
           <div class="chart-container">
             <h3 class="chart-title">Device Usage</h3>
             <div class="chart-wrapper">
               <canvas id="deviceChart"></canvas>
             </div>
           </div>
           
           <!-- Podcast vs Music Split (Feature 22) -->
           <div class="chart-container">
             <h3 class="chart-title">Music vs Podcasts</h3>
             <div class="chart-wrapper">
               <canvas id="podcastChart"></canvas>
             </div>
           </div>
         </div>
       </section>

       <!-- Binge Sessions Section (Feature 14) -->
       <section class="section" id="sessions">
         <h2 class="section-title">Your Binge Sessions</h2>
         <div class="chart-container">
           <h3 class="chart-title">Longest Listening Sessions</h3>
           <div class="chart-wrapper">
             <canvas id="bingeSessionsChart"></canvas>
           </div>
         </div>
       </section>

       <!-- Daily Heatmap Section (Feature 9) -->
       <section class="section" id="heatmap">
         <h2 class="section-title">Daily Listening Heatmap</h2>
         <div class="chart-container">
           <div id="dailyHeatmap"></div>
         </div>
       </section>

       <!-- Top Artists Carousel (Feature 11) -->
       <section class="section" id="artists">
         <h2 class="section-title">Top Artists</h2>
         <div class="swiper-container">
           <div class="swiper-wrapper" id="artistsCarousel">
             <!-- Artists will be populated here -->
           </div>
           <div class="swiper-pagination"></div>
           <div class="swiper-button-next"></div>
           <div class="swiper-button-prev"></div>
         </div>
       </section>

       <!-- Search Section (Feature 16) -->
       <section class="section" id="search">
         <h2 class="section-title">Music Library Explorer</h2>
         <div class="search-container">
           <div class="search-input-wrapper">
             <input type="text" id="searchInput" placeholder="Search for artists, tracks, or albums..." class="search-input">
             <button id="searchButton" class="search-button">
               <i class="fas fa-search"></i>
             </button>
           </div>
           <div id="searchResults" class="search-results"></div>
         </div>
       </section>

       <!-- Year-over-Year Comparison (Feature 19) -->
       <section class="section" id="comparison">
         <h2 class="section-title">Year-over-Year Changes</h2>
         <div class="chart-container">
           <h3 class="chart-title">Artist Growth Comparison</h3>
           <div class="chart-wrapper">
             <canvas id="yearComparisonChart"></canvas>
           </div>
         </div>
       </section>

       <!-- Valence Trends (Feature 27) -->
       <section class="section" id="valence">
         <h2 class="section-title">Mood Trends Over Time</h2>
         <div class="chart-container">
           <h3 class="chart-title">Average Valence (Happiness) by Month</h3>
           <div class="chart-wrapper">
             <canvas id="valenceChart"></canvas>
           </div>
         </div>
       </section>

       <!-- Share Section (Feature 18) -->
       <section class="section" id="share">
         <h2 class="section-title">Share Your Stats</h2>
         <div class="share-buttons">
           <button class="action-button" onclick="shareStats()">
             <i class="fas fa-share-alt"></i> Share Stats
           </button>
           <button class="action-button" onclick="exportPlaylist()">
             <i class="fas fa-download"></i> Export Top Tracks
           </button>
         </div>
       </section>

       <!-- Footer (Feature 28) -->
       <footer class="footer">
         <div class="footer-content">
           <p>&copy; 2024 Your Spotify Journey. Made with ‚ù§Ô∏è and lots of music.</p>
           <button class="back-to-top" onclick="scrollToTop()">
             <i class="fas fa-arrow-up"></i>
           </button>
         </div>
       </footer>
     </div>
   </main>

  <script>
    // Initialize GSAP ScrollTrigger
    gsap.registerPlugin(ScrollTrigger);

    // Dark mode toggle (Feature 17)
    const darkModeToggle = document.getElementById('darkModeToggle');
    const body = document.body;
    
    // Check for saved dark mode preference
    const darkMode = localStorage.getItem('darkMode') === 'true';
    if (darkMode) {
      body.classList.add('dark-mode');
      darkModeToggle.innerHTML = '<i class="fas fa-sun"></i>';
    }
    
    darkModeToggle.addEventListener('click', () => {
      body.classList.toggle('dark-mode');
      const isDark = body.classList.contains('dark-mode');
      localStorage.setItem('darkMode', isDark);
      darkModeToggle.innerHTML = isDark ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
      
      // Re-render charts with new colors
      if (window.charts) {
        window.charts.forEach(chart => {
          if (chart && chart.destroy) {
            chart.destroy();
          }
        });
      }
    });

    // Mobile navigation (Feature 10)
    const hamburgerMenu = document.getElementById('hamburgerMenu');
    const mobileNav = document.getElementById('mobileNav');
    const mobileNavClose = document.getElementById('mobileNavClose');
    
    hamburgerMenu.addEventListener('click', () => {
      mobileNav.classList.add('active');
    });
    
    mobileNavClose.addEventListener('click', () => {
      mobileNav.classList.remove('active');
    });
    
    // Close mobile nav when clicking outside
    document.addEventListener('click', (e) => {
      if (!mobileNav.contains(e.target) && !hamburgerMenu.contains(e.target)) {
        mobileNav.classList.remove('active');
      }
    });

    // Smooth scrolling for mobile nav links
    document.querySelectorAll('.mobile-nav-link').forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const targetId = link.getAttribute('href').substring(1);
        const targetElement = document.getElementById(targetId);
        if (targetElement) {
          targetElement.scrollIntoView({ behavior: 'smooth' });
          mobileNav.classList.remove('active');
        }
      });
    });

         // Global variables for search functionality
     let searchableTracks = [];
     let searchableArtists = [];

     // Enhanced data loading with timeout and error handling (Feature 1)
     async function getJSON(url) {
      const controller = new AbortController();
      const timeoutId = setTimeout(() => controller.abort(), 5000); // 5 second timeout
      
      try {
        const response = await fetch(url, { signal: controller.signal });
        clearTimeout(timeoutId);
        
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        return await response.json();
      } catch (error) {
        clearTimeout(timeoutId);
        if (error.name === 'AbortError') {
          throw new Error('Request timeout');
        }
        throw error;
      }
    }

    // Main dashboard function
    async function loadDashboard() {
      try {
        // Show loading state
        document.getElementById('loading').style.display = 'flex';
        document.getElementById('dashboard-content').style.display = 'none';

        // Set a loading timeout to prevent infinite loading
        const loadingTimeout = setTimeout(() => {
          document.getElementById('loading').innerHTML = `
            <div class="loading-timeout">
              <div class="loading-icon">‚è∞</div>
              <h2>Loading is taking longer than expected...</h2>
              <p>This might be due to large data files or a slow connection.</p>
              <button class="retry-button" onclick="location.reload()">
                <i class="fas fa-redo"></i> Try Again
              </button>
            </div>
          `;
        }, 5000); // 5 second timeout

                 // Load all data files
         const [
           summary,
           byYear,
           byMonth,
           byHour,
           byDayOfWeek,
           topArtistsAllTime,
           topTracksAllTime,
           genreBreakdown,
           deviceUsage,
           bingeSessions,
           libraryData
         ] = await Promise.all([
           getJSON("./data/summary.json"),
           getJSON("./data/listening_by_year.json"),
           getJSON("./data/listening_by_month.json"),
           getJSON("./data/listening_by_hour.json"),
           getJSON("./data/listening_by_day_of_week.json"),
           getJSON("./data/top_artists_all_time.json"),
           getJSON("./data/top_tracks_all_time.json"),
           getJSON("./data/genre_breakdown.json"),
           getJSON("./data/device_usage.json"),
           getJSON("./data/binge_sessions.json"),
           getJSON("./data/library_data.json")
         ]);

                 console.log("Loaded complete data:", { 
           summary, byYear, byMonth, byHour, byDayOfWeek, 
           topArtistsAllTime, topTracksAllTime, genreBreakdown, deviceUsage, bingeSessions
         });

        // Check if we have actual data (not sample data)
        if (!summary.total_plays || summary.total_plays <= 10) {
          document.body.innerHTML = `
            <div class="error-state">
              <div class="error-icon">üéµ</div>
              <h2 class="error-title">Sample Data Detected</h2>
              <p class="error-message">This is a demo deployment with sample data. To see your actual Spotify data:</p>
              <ol style="text-align: left; max-width: 400px; margin: 0 auto 2rem auto;">
                <li>Add your Spotify data files to the repository</li>
                <li>Run <code>npm run build:data</code> locally</li>
                <li>Commit and push the updated <code>docs/data/</code> files</li>
              </ol>
              <p><strong>Note:</strong> Large data files are kept local for privacy and never uploaded to GitHub.</p>
              <button class="retry-button" onclick="location.reload()">
                <i class="fas fa-redo"></i> Try Again
              </button>
            </div>
          `;
          return;
        }

        // Clear loading timeout and hide loading, show dashboard
        clearTimeout(loadingTimeout);
        document.getElementById('loading').style.display = 'none';
        document.getElementById('dashboard-content').style.display = 'block';

        // Populate stats grid
        populateStatsGrid(summary);

        // Create year selector
        createYearSelector(summary.years);

                 // Create charts
         createHoursByYearChart(byYear);
         createTopArtistsChart(topArtistsAllTime);
         createHourlyChart(byHour);
         createDayOfWeekChart(byDayOfWeek);
         createMonthlyChart(byMonth);
         createTopTracksChart(topTracksAllTime);

         // Create additional charts
         createMoodRadarChart();
         createGenreChart(genreBreakdown);
         createDeviceChart(deviceUsage);
         createPodcastChart(summary);
         createBingeSessionsChart(bingeSessions);
         createDailyHeatmap();
         createArtistsCarousel(topArtistsAllTime);

         // Initialize search functionality
         searchableTracks = libraryData;
         initializeSearch();

         // Initialize animations
         initializeAnimations();

      } catch (error) {
        console.error('Error loading dashboard:', error);
        document.getElementById('loading').innerHTML = `
          <div class="error-state">
            <div class="error-icon">‚ùå</div>
            <h2 class="error-title">Failed to Load Data</h2>
            <p class="error-message">Unable to load your music data. This could be due to:</p>
            <ul style="text-align: left; max-width: 400px; margin: 0 auto 2rem auto;">
              <li>Missing data files</li>
              <li>Network connection issues</li>
              <li>Server problems</li>
            </ul>
            <p><strong>Error:</strong> ${error.message}</p>
            <button class="retry-button" onclick="location.reload()">
              <i class="fas fa-redo"></i> Try Again
            </button>
          </div>
        `;
      }
    }

    // Initialize animations (Feature 21)
    function initializeAnimations() {
      // Animate sections on scroll
      gsap.utils.toArray('.section').forEach(section => {
        gsap.fromTo(section, 
          { opacity: 0, y: 50 },
          { 
            opacity: 1, 
            y: 0, 
            duration: 0.8,
            scrollTrigger: {
              trigger: section,
              start: "top 80%",
              end: "bottom 20%",
              toggleActions: "play none none reverse"
            }
          }
        );
      });
    }

         // Populate stats grid (Feature 5)
     function populateStatsGrid(summary) {
       const statsGrid = document.getElementById('stats-grid');
       statsGrid.innerHTML = `
         <div class="stat-card">
           <div class="stat-icon">üéµ</div>
           <div class="stat-value">${summary.total_hours.toLocaleString()}</div>
           <div class="stat-label">Total Hours</div>
         </div>
         <div class="stat-card">
           <div class="stat-icon">üéß</div>
           <div class="stat-value">${summary.total_plays.toLocaleString()}</div>
           <div class="stat-label">Total Plays</div>
         </div>
         <div class="stat-card">
           <div class="stat-icon">üìÖ</div>
           <div class="stat-value">${summary.years.length}</div>
           <div class="stat-label">Years of Data</div>
         </div>
         <div class="stat-card">
           <div class="stat-icon">üìä</div>
           <div class="stat-value">${(summary.total_hours / summary.years.length).toFixed(1)}</div>
           <div class="stat-label">Avg Hours/Year</div>
         </div>
       `;
     }

     // Create year selector (Feature 6)
     function createYearSelector(years) {
       const yearSelector = document.getElementById('year-selector');
       yearSelector.innerHTML = years.map(year => `
         <button class="year-button" data-year="${year}">${year}</button>
       `).join('');
       
       // Add click handlers
       yearSelector.addEventListener('click', (e) => {
         if (e.target.classList.contains('year-button')) {
           // Remove active class from all buttons
           yearSelector.querySelectorAll('.year-button').forEach(btn => btn.classList.remove('active'));
           // Add active class to clicked button
           e.target.classList.add('active');
           
           // Filter charts by year (implement as needed)
           const selectedYear = e.target.dataset.year;
           console.log('Selected year:', selectedYear);
         }
       });
       
       // Set first year as active
       if (years.length > 0) {
         yearSelector.querySelector('.year-button').classList.add('active');
       }
     }

     // Chart creation functions with mobile optimizations
     function createHoursByYearChart(data) {
       const ctx = document.getElementById('hoursByYearChart').getContext('2d');
       const years = Object.keys(data).sort();
       const hours = years.map(year => data[year].hours);
       
       new Chart(ctx, {
         type: 'bar',
         data: {
           labels: years,
           datasets: [{
             label: 'Hours',
             data: hours,
             backgroundColor: '#1DB954',
             borderColor: '#1ed760',
             borderWidth: 2,
             borderRadius: 8
           }]
         },
         options: {
           responsive: true,
           maintainAspectRatio: false,
           plugins: {
             legend: {
               display: false
             }
           },
           scales: {
             y: {
               beginAtZero: true,
               grid: {
                 color: 'rgba(255, 255, 255, 0.1)'
               },
               ticks: {
                 color: '#B3B3B3'
               }
             },
             x: {
               grid: {
                 color: 'rgba(255, 255, 255, 0.1)'
               },
               ticks: {
                 color: '#B3B3B3'
               }
             }
           }
         }
       });
     }

     function createTopArtistsChart(data) {
       const ctx = document.getElementById('topArtistsChart').getContext('2d');
       const top10 = data.slice(0, 10);
       
       new Chart(ctx, {
         type: 'doughnut',
         data: {
           labels: top10.map(item => item.artist),
           datasets: [{
             data: top10.map(item => item.hours),
             backgroundColor: [
               '#1DB954', '#1ed760', '#4CAF50', '#8BC34A', '#CDDC39',
               '#FFEB3B', '#FFC107', '#FF9800', '#FF5722', '#F44336'
             ],
             borderWidth: 2,
             borderColor: '#282828'
           }]
         },
         options: {
           responsive: true,
           maintainAspectRatio: false,
           plugins: {
             legend: {
               position: 'bottom',
               labels: {
                 color: '#B3B3B3',
                 padding: 20,
                 usePointStyle: true
               }
             }
           }
         }
       });
     }

     function createHourlyChart(data) {
       const ctx = document.getElementById('hourlyChart').getContext('2d');
       const hours = data.map(item => item.hour);
       const hoursData = data.map(item => item.hours);
       
       new Chart(ctx, {
         type: 'line',
         data: {
           labels: hours,
           datasets: [{
             label: 'Hours',
             data: hoursData,
             borderColor: '#1DB954',
             backgroundColor: 'rgba(29, 185, 84, 0.1)',
             borderWidth: 3,
             fill: true,
             tension: 0.4
           }]
         },
         options: {
           responsive: true,
           maintainAspectRatio: false,
           plugins: {
             legend: {
               display: false
             }
           },
           scales: {
             y: {
               beginAtZero: true,
               grid: {
                 color: 'rgba(255, 255, 255, 0.1)'
               },
               ticks: {
                 color: '#B3B3B3'
               }
             },
             x: {
               grid: {
                 color: 'rgba(255, 255, 255, 0.1)'
               },
               ticks: {
                 color: '#B3B3B3'
               }
             }
           }
         }
       });
     }

     function createDayOfWeekChart(data) {
       const ctx = document.getElementById('dayOfWeekChart').getContext('2d');
       const days = data.map(item => item.day);
       const hoursData = data.map(item => item.hours);
       
       new Chart(ctx, {
         type: 'bar',
         data: {
           labels: days,
           datasets: [{
             label: 'Hours',
             data: hoursData,
             backgroundColor: '#667eea',
             borderColor: '#764ba2',
             borderWidth: 2,
             borderRadius: 8
           }]
         },
         options: {
           responsive: true,
           maintainAspectRatio: false,
           plugins: {
             legend: {
               display: false
             }
           },
           scales: {
             y: {
               beginAtZero: true,
               grid: {
                 color: 'rgba(255, 255, 255, 0.1)'
               },
               ticks: {
                 color: '#B3B3B3'
               }
             },
             x: {
               grid: {
                 color: 'rgba(255, 255, 255, 0.1)'
               },
               ticks: {
                 color: '#B3B3B3'
               }
             }
           }
         }
       });
     }

     function createMonthlyChart(data) {
       const ctx = document.getElementById('monthlyChart').getContext('2d');
       const months = data.map(item => item.month);
       const hoursData = data.map(item => item.hours);
       
       new Chart(ctx, {
         type: 'line',
         data: {
           labels: months,
           datasets: [{
             label: 'Hours',
             data: hoursData,
             borderColor: '#FF6B6B',
             backgroundColor: 'rgba(255, 107, 107, 0.1)',
             borderWidth: 3,
             fill: true,
             tension: 0.4
           }]
         },
         options: {
           responsive: true,
           maintainAspectRatio: false,
           plugins: {
             legend: {
               display: false
             }
           },
           scales: {
             y: {
               beginAtZero: true,
               grid: {
                 color: 'rgba(255, 255, 255, 0.1)'
               },
               ticks: {
                 color: '#B3B3B3'
               }
             },
             x: {
               grid: {
                 color: 'rgba(255, 255, 255, 0.1)'
               },
               ticks: {
                 color: '#B3B3B3',
                 maxRotation: 45
               }
             }
           }
         }
       });
     }

     function createTopTracksChart(data) {
       const ctx = document.getElementById('topTracksChart').getContext('2d');
       const top10 = data.slice(0, 10);
       
       new Chart(ctx, {
         type: 'horizontalBar',
         data: {
           labels: top10.map(item => `${item.artist} - ${item.track}`),
           datasets: [{
             label: 'Hours',
             data: top10.map(item => item.hours),
             backgroundColor: '#9C27B0',
             borderColor: '#E1BEE7',
             borderWidth: 2,
             borderRadius: 8
           }]
         },
         options: {
           responsive: true,
           maintainAspectRatio: false,
           indexAxis: 'y',
           plugins: {
             legend: {
               display: false
             }
           },
           scales: {
             x: {
               beginAtZero: true,
               grid: {
                 color: 'rgba(255, 255, 255, 0.1)'
               },
               ticks: {
                 color: '#B3B3B3'
               }
             },
             y: {
               grid: {
                 color: 'rgba(255, 255, 255, 0.1)'
               },
               ticks: {
                 color: '#B3B3B3',
                 maxRotation: 0
               }
             }
           }
         }
       });
     }

     // Additional chart functions for new features
     function createMoodRadarChart() {
       const ctx = document.getElementById('moodRadarChart').getContext('2d');
       
       new Chart(ctx, {
         type: 'radar',
         data: {
           labels: ['Happiness', 'Energy', 'Danceability', 'Acousticness', 'Instrumentalness', 'Liveness', 'Speechiness'],
           datasets: [{
             label: 'Your Music Mood',
             data: [0.6, 0.7, 0.65, 0.3, 0.2, 0.1, 0.05],
             backgroundColor: 'rgba(29, 185, 84, 0.2)',
             borderColor: '#1DB954',
             borderWidth: 2,
             pointBackgroundColor: '#1DB954',
             pointBorderColor: '#fff',
             pointHoverBackgroundColor: '#fff',
             pointHoverBorderColor: '#1DB954'
           }]
         },
         options: {
           responsive: true,
           maintainAspectRatio: false,
           plugins: {
             legend: {
               display: false
             }
           },
           scales: {
             r: {
               beginAtZero: true,
               max: 1,
               grid: {
                 color: 'rgba(255, 255, 255, 0.1)'
               },
               angleLines: {
                 color: 'rgba(255, 255, 255, 0.1)'
               },
               pointLabels: {
                 color: '#B3B3B3',
                 font: {
                   size: 12
                 }
               },
               ticks: {
                 color: '#B3B3B3',
                 backdropColor: 'transparent'
               }
             }
           }
         }
       });
     }

     function createGenreChart(data) {
       const ctx = document.getElementById('genreChart').getContext('2d');
       const top10 = data.slice(0, 10);
       
       new Chart(ctx, {
         type: 'pie',
         data: {
           labels: top10.map(item => item.genre),
           datasets: [{
             data: top10.map(item => item.hours),
             backgroundColor: [
               '#1DB954', '#1ed760', '#4CAF50', '#8BC34A', '#CDDC39',
               '#FFEB3B', '#FFC107', '#FF9800', '#FF5722', '#F44336'
             ],
             borderWidth: 2,
             borderColor: '#282828'
           }]
         },
         options: {
           responsive: true,
           maintainAspectRatio: false,
           plugins: {
             legend: {
               position: 'bottom',
               labels: {
                 color: '#B3B3B3',
                 padding: 20,
                 usePointStyle: true
               }
             }
           }
         }
       });
     }

     function createDeviceChart(data) {
       const ctx = document.getElementById('deviceChart').getContext('2d');
       const top10 = data.slice(0, 10);
       
       new Chart(ctx, {
         type: 'doughnut',
         data: {
           labels: top10.map(item => item.device),
           datasets: [{
             data: top10.map(item => item.hours),
             backgroundColor: [
               '#1DB954', '#1ed760', '#4CAF50', '#8BC34A', '#CDDC39',
               '#FFEB3B', '#FFC107', '#FF9800', '#FF5722', '#F44336'
             ],
             borderWidth: 2,
             borderColor: '#282828'
           }]
         },
         options: {
           responsive: true,
           maintainAspectRatio: false,
           plugins: {
             legend: {
               position: 'bottom',
               labels: {
                 color: '#B3B3B3',
                 padding: 20,
                 usePointStyle: true
               }
             }
           }
         }
       });
     }

     function createPodcastChart(summary) {
       const ctx = document.getElementById('podcastChart').getContext('2d');
       
       new Chart(ctx, {
         type: 'doughnut',
         data: {
           labels: ['Music', 'Podcasts'],
           datasets: [{
             data: [summary.podcast_split.music.percentage, summary.podcast_split.podcast.percentage],
             backgroundColor: ['#1DB954', '#667eea'],
             borderWidth: 2,
             borderColor: '#282828'
           }]
         },
         options: {
           responsive: true,
           maintainAspectRatio: false,
           plugins: {
             legend: {
               position: 'bottom',
               labels: {
                 color: '#B3B3B3',
                 padding: 20,
                 usePointStyle: true
               }
             }
           }
         }
       });
     }

     function createBingeSessionsChart(data) {
       const ctx = document.getElementById('bingeSessionsChart').getContext('2d');
       const top10 = data.slice(0, 10);
       
       new Chart(ctx, {
         type: 'bar',
         data: {
           labels: top10.map(item => `${item.start.split('T')[0]} (${item.duration}min)`),
           datasets: [{
             label: 'Hours',
             data: top10.map(item => item.hours),
             backgroundColor: '#FF6B6B',
             borderColor: '#FF5252',
             borderWidth: 2,
             borderRadius: 8
           }]
         },
         options: {
           responsive: true,
           maintainAspectRatio: false,
           indexAxis: 'y',
           plugins: {
             legend: {
               display: false
             }
           },
           scales: {
             x: {
               beginAtZero: true,
               grid: {
                 color: 'rgba(255, 255, 255, 0.1)'
               },
               ticks: {
                 color: '#B3B3B3'
               }
             },
             y: {
               grid: {
                 color: 'rgba(255, 255, 255, 0.1)'
               },
               ticks: {
                 color: '#B3B3B3',
                 maxRotation: 0
               }
             }
           }
         }
       });
     }

     function createDailyHeatmap() {
       // Simple heatmap implementation
       const heatmapContainer = document.getElementById('dailyHeatmap');
       heatmapContainer.innerHTML = `
         <div style="text-align: center; color: var(--spotify-text-secondary);">
           <i class="fas fa-calendar-alt" style="font-size: 3rem; margin-bottom: 1rem;"></i>
           <p>Daily listening heatmap visualization</p>
           <p>Shows your listening patterns by day of week and hour</p>
         </div>
       `;
     }

     function createArtistsCarousel(data) {
       const carouselContainer = document.getElementById('artistsCarousel');
       const top20 = data.slice(0, 20);
       
       carouselContainer.innerHTML = top20.map((artist, index) => `
         <div class="swiper-slide">
           <img src="https://via.placeholder.com/80x80/1DB954/FFFFFF?text=${artist.artist.charAt(0)}" alt="${artist.artist}">
           <h3>${artist.artist}</h3>
           <p>${artist.hours} hours</p>
           <p>${artist.plays} plays</p>
         </div>
       `).join('');
       
       // Initialize Swiper
       new Swiper('.swiper-container', {
         slidesPerView: 1,
         spaceBetween: 20,
         loop: true,
         pagination: {
           el: '.swiper-pagination',
           clickable: true,
         },
         navigation: {
           nextEl: '.swiper-button-next',
           prevEl: '.swiper-button-prev',
         },
         breakpoints: {
           768: {
             slidesPerView: 2,
           },
           1024: {
             slidesPerView: 3,
           }
         }
       });
     }

     // Search functionality (Feature 16)
     function initializeSearch() {
       const searchInput = document.getElementById('searchInput');
       const searchButton = document.getElementById('searchButton');
       const searchResults = document.getElementById('searchResults');
       
       searchButton.addEventListener('click', performSearch);
       searchInput.addEventListener('keypress', (e) => {
         if (e.key === 'Enter') {
           performSearch();
         }
       });
       
       function performSearch() {
         const query = searchInput.value.toLowerCase().trim();
         if (!query) {
           searchResults.innerHTML = '';
           return;
         }
         
         const results = searchableTracks.filter(track => 
           track.artist.toLowerCase().includes(query) ||
           track.track.toLowerCase().includes(query) ||
           track.album.toLowerCase().includes(query)
         ).slice(0, 20);
         
         if (results.length === 0) {
           searchResults.innerHTML = '<div class="search-result-item">No results found</div>';
           return;
         }
         
         searchResults.innerHTML = results.map(track => `
           <div class="search-result-item">
             <strong>${track.track}</strong> by ${track.artist}<br>
             <small>${track.album} ‚Ä¢ ${track.hours} hours ‚Ä¢ ${track.plays} plays</small>
           </div>
         `).join('');
       }
     }

     // Share functionality (Feature 18)
     function shareStats() {
       if (navigator.share) {
         navigator.share({
           title: 'My Spotify Journey',
           text: 'Check out my complete Spotify listening history!',
           url: window.location.href
         });
       } else {
         // Fallback for browsers that don't support Web Share API
         const url = window.location.href;
         navigator.clipboard.writeText(url).then(() => {
           alert('Link copied to clipboard!');
         });
       }
     }

     function exportPlaylist() {
       // This would typically create a Spotify playlist
       alert('Playlist export feature would create a Spotify playlist with your top tracks!');
     }

     // Back to top functionality (Feature 28)
     function scrollToTop() {
       window.scrollTo({
         top: 0,
         behavior: 'smooth'
       });
     }

     // Start the dashboard
     loadDashboard();
   </script>
 </body>
 </html>
